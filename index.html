<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>æœƒè€ƒæˆ°å£«ï¼šè£œçµ¦ç¸½éƒ¨ v2.6 ç¾é£Ÿè±å¯Œç‰ˆ</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background-color: #f4f4f9; padding: 20px; }
        .container { max-width: 600px; margin: auto; background: white; padding: 20px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        .stats { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; background: #eee; padding: 15px; border-radius: 10px; margin-bottom: 20px; font-weight: bold; text-align: center; }
        .menu { display: flex; gap: 5px; margin-bottom: 20px; flex-wrap: wrap; justify-content: center; }
        button { padding: 8px 10px; cursor: pointer; border: none; border-radius: 8px; background: #6c5ce7; color: white; font-size: 0.85em; }
        .section { display: none; }
        .active { display: block; }
        .item-card { border: 1px solid #ddd; padding: 10px; margin: 8px 0; border-radius: 8px; display: flex; justify-content: space-between; align-items: center; }
        .tag { font-size: 0.7em; padding: 2px 5px; border-radius: 4px; color: white; margin-left: 5px; }
        .tag-food { background: #ff7675; }
        .tag-skin { background: #55efc4; color: #000; }
        .tag-makeup { background: #fdcb6e; color: #000; }
        .status-msg { color: #e74c3c; font-weight: bold; text-align: center; min-height: 1.5em; margin-bottom: 10px; }
    </style>
</head>
<body>

<div class="container">
    <h1>ç¥å¥‡è£œçµ¦ç¸½éƒ¨ v2.6</h1>

    <div id="author-note-display" style="background:#e8f4fd; padding:10px; border-radius:8px; margin-bottom:15px;">
        <strong>ğŸ“¢ ä½œè€…å…¬å‘Šï¼š</strong> <span id="display-note">è¼‰å…¥ä¸­...</span>
    </div>

    <div id="gift-area"></div>

    <div class="stats">
        <div>ğŸ’° é‡‘å¹£<br><span id="money">--</span></div>
        <div>âœ¨ é¡å€¼<br><span id="beauty">--</span>/100</div>
        <div>ğŸ” é£½é£Ÿ<br><span id="hunger">--</span>/100</div>
    </div>

    <div style="text-align:center; font-size:0.8em; margin-bottom:10px; background:#f1f2f6; padding:5px; border-radius:20px;">
        ğŸš¿ <span id="last-wash-display">--</span> | ğŸ§´ çš®è†šï¼š<span id="skin-status-display">è‰¯å¥½</span>
    </div>

    <div class="menu">
        <button onclick="showSection('work')">è³ºéŒ¢</button>
        <button onclick="showSection('shop')">å•†åº—</button>
        <button onclick="showSection('inventory')">ğŸ’ èƒŒåŒ…</button>
        <button onclick="showSection('diary')">è¯çµ¡ç°¿</button>
        <button onclick="washHair()" style="background:#3498db;">ğŸš¿ æ´—é ­</button>
        <button onclick="checkIn()">ğŸ“… ç°½åˆ°</button>
        <button onclick="toggleAdmin()" style="background:#95a5a6;">âš™ï¸ ç®¡ç†</button>
    </div>

    <div id="status-display" class="status-msg"></div>

    <div id="shop" class="section">
        <h3>ğŸ” ç¾é£Ÿè£œçµ¦å€</h3>
        <div class="item-card"><span>æ‡‰æ€¥åå¸ <span class="tag tag-food">+20 é£½é£Ÿ</span></span><button onclick="buyItem('æ‡‰æ€¥åå¸', 50, 'food', 20)">$50</button></div>
        <div class="item-card"><span>å¾¡é£¯ç³° <span class="tag tag-food">+35 é£½é£Ÿ</span></span><button onclick="buyItem('å¾¡é£¯ç³°', 80, 'food', 35)">$80</button></div>
        <div class="item-card"><span>çç å¥¶èŒ¶ <span class="tag tag-food">+15 é£½é£Ÿ +10 é¡å€¼</span></span><button onclick="buyItem('çç å¥¶èŒ¶', 100, 'food_plus', 15, 10)">$100</button></div>
        <div class="item-card"><span>å°å¼æ’éª¨é£¯ <span class="tag tag-food">+80 é£½é£Ÿ</span></span><button onclick="buyItem('æ’éª¨é£¯', 250, 'food', 80)">$250</button></div>
        <div class="item-card"><span>è‰è“å¤§ç¦ <span class="tag tag-food">+10 é£½é£Ÿ +15 é¡å€¼</span></span><button onclick="buyItem('è‰è“å¤§ç¦', 120, 'food_plus', 10, 15)">$120</button></div>
        
        <hr>
        <h3>ğŸ§´ ä¿é¤Šèˆ‡å½©å¦å€</h3>
        <div class="item-card"><span>Nature Face å™´éœ§</span><button onclick="buyItem('Nature Face å™´éœ§', 150, 'skin', 8)">$150</button></div>
        <div class="item-card"><span>é›ªèŠ™è˜­åŒ–å¦æ°´</span><button onclick="buyItem('é›ªèŠ™è˜­åŒ–å¦æ°´', 120, 'skin', 10)">$120</button></div>
        <div class="item-card"><span>æ›¼ç§€é›·æ•¦èª¿ç†æ°´</span><button onclick="buyItem('èª¿ç†æ°´', 120, 'skin', 8)">$120</button></div>
        <div class="item-card"><span>æƒ¹æˆ‘èœœç²‰ <span class="tag tag-makeup">éœ€å¸å¦</span></span><button onclick="buyItem('æƒ¹æˆ‘èœœç²‰', 160, 'makeup', 15)">$160</button></div>
        <div class="item-card"><span>é›ªèŠ™è˜­å¸å¦æ°´</span><button onclick="buyItem('å¸å¦æ°´', 150, 'clean', 0)">$150</button></div>
        <div class="item-card"><span>å¯ç«‹ä¿¡ç—˜ç—˜å‡è† </span><button onclick="buyItem('ç—˜ç—˜è†', 220, 'cure', 0)">$220</button></div>
    </div>

    <div id="inventory" class="section"><h3>ğŸ’ èƒŒåŒ…</h3><div id="inventory-display"></div></div>
    <div id="work" class="section active"><button onclick="clickWork()" style="width:100%; padding:20px; background:#ff7675; border-radius:10px; color:white; border:none; font-weight:bold;">æ‰“å·¥è³ºéŒ¢ (é»æ“Š +10, é£½é£Ÿ -1)</button></div>
    <div id="diary" class="section"><h3>è¯çµ¡ç°¿</h3><textarea id="diary-box" oninput="saveDiary()" style="width:100%; height:150px;" placeholder="ä»Šå¤©æœ‰ä»€éº¼æƒ³èªªçš„ï¼Ÿ"></textarea></div>

    <div id="admin-panel" style="display:none; padding:10px; background:#eee; border-radius:10px; margin-top:10px;">
        <input type="password" id="admin-pass" placeholder="è¼¸å…¥å¯†ç¢¼ 0287901003" style="width:100%;">
        <textarea id="edit-note" placeholder="ä¿®æ”¹å…¬å‘Š..."></textarea>
        <button onclick="updateNote()" style="background:#2ecc71; width:100%;">ç¢ºèªä¿®æ”¹</button>
    </div>
</div>

<script>
    const SAVE_KEY = "magicShop_Final_Save_v2.6";
    let state = { 
        money: 500, beauty: 80, hunger: 70, inventory: [], 
        lastCheckIn: "", authorNote: "æ­¡è¿å›ä¾†ï¼", 
        diaryContent: "", hasReceivedGift: false,
        lastWashTime: Date.now(), isDirty: false, hasAcne: false
    };

    function saveGame() { localStorage.setItem(SAVE_KEY, JSON.stringify(state)); }
    function loadGame() {
        const saved = localStorage.getItem(SAVE_KEY);
        if (saved) state = Object.assign(state, JSON.parse(saved));
        document.getElementById('display-note').innerText = state.authorNote;
        document.getElementById('diary-box').value = state.diaryContent || "";
        checkGift();
    }

    setInterval(() => {
        if (state.hunger > 0) state.hunger -= 0.05;
        if (state.isDirty && Math.random() < 0.0005) state.hasAcne = true;
        saveGame(); updateUI();
    }, 1000);

    function buyItem(name, price, type, power, beautyPower = 0) {
        if (state.money < price) { alert("é‡‘å¹£ä¸è¶³ï¼"); return; }
        state.money -= price;
        state.inventory.push({ name, type, power, beautyPower });
        saveGame(); updateUI("è³¼å…¥äº† " + name);
    }

    function useItem(index) {
        const item = state.inventory[index];
        if (item.type === 'food') state.hunger = Math.min(100, state.hunger + item.power);
        else if (item.type === 'food_plus') { 
            state.hunger = Math.min(100, state.hunger + item.power);
            state.beauty = Math.min(100, state.beauty + item.beautyPower);
        }
        else if (item.type === 'clean') state.isDirty = false;
        else if (item.type === 'cure' && state.hasAcne) { state.hasAcne = false; state.beauty += 15; }
        else {
            state.beauty = Math.min(100, state.beauty + item.power);
            if (item.type === 'makeup') state.isDirty = true;
        }
        state.inventory.splice(index, 1);
        saveGame(); renderInventory(); updateUI("ä½¿ç”¨äº† " + item.name);
    }

    function renderInventory() {
        const div = document.getElementById('inventory-display');
        div.innerHTML = state.inventory.length === 0 ? "ç©ºç©ºå¦‚ä¹Ÿ" : "";
        state.inventory.forEach((item, index) => {
            div.innerHTML += `<div class="item-card"><span>${item.name}</span><button onclick="useItem(${index})" style="background:#2ecc71">ä½¿ç”¨</button></div>`;
        });
    }

    function clickWork() { if (state.hunger >= 1) { state.money += 10; state.hunger -= 1; updateUI(); } }
    function washHair() { state.lastWashTime = Date.now(); state.beauty = Math.min(100, state.beauty + 5); saveGame(); }
    function checkIn() {
        const today = new Date().toLocaleDateString();
        if (state.lastCheckIn === today) alert("é ˜éå›‰ï¼");
        else { state.money += 100; state.lastCheckIn = today; saveGame(); updateUI("ç°½åˆ°æˆåŠŸï¼"); }
    }
    function saveDiary() { state.diaryContent = document.getElementById('diary-box').value; saveGame(); }
    function showSection(id) { document.querySelectorAll('.section').forEach(s => s.classList.remove('active')); document.getElementById(id).classList.add('active'); if (id === 'inventory') renderInventory(); }
    
    function updateUI(msg) {
        document.getElementById('money').innerText = Math.floor(state.money);
        document.getElementById('beauty').innerText = Math.floor(state.beauty);
        document.getElementById('hunger').innerText = Math.floor(state.hunger);
        if (msg) document.getElementById('status-display').innerText = msg;
        let hours = ((Date.now() - state.lastWashTime) / (1000 * 60 * 60)).toFixed(1);
        document.getElementById('last-wash-display').innerText = hours + " å°æ™‚å‰æ´—é ­";
        document.getElementById('skin-status-display').innerText = state.hasAcne ? "âš ï¸ ç—˜ç—˜" : (state.isDirty ? "å¸¶å¦" : "è‰¯å¥½");
    }

    function checkGift() {
        const area = document.getElementById('gift-area');
        if (!state.hasReceivedGift) area.innerHTML = `<div style="background:#fff3f3; padding:10px; border:2px dashed #ff7675; text-align:center; margin-bottom:10px;">ğŸ å¤§ç¦®åŒ… <button onclick="receiveGift()" style="background:#ff7675">é ˜å–</button></div>`;
        else area.innerHTML = "";
    }
    function receiveGift() { state.money += 300; state.hasReceivedGift = true; checkGift(); saveGame(); }
    function toggleAdmin() { const p = document.getElementById('admin-panel'); p.style.display = (p.style.display === 'block' ? 'none' : 'block'); }
    function updateNote() {
        if (document.getElementById('admin-pass').value === "0287901003") {
            state.authorNote = document.getElementById('edit-note').value;
            document.getElementById('display-note').innerText = state.authorNote;
            saveGame(); alert("å…¬å‘Šå·²æ›´æ–°ï¼");
        } else alert("å¯†ç¢¼éŒ¯èª¤");
    }

    loadGame(); updateUI();
</script>
</body>
</html>
