<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>æœƒè€ƒæˆ°å£«ï¼šç¥å¥‡è£œçµ¦ç¸½éƒ¨ v2.2.2</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background-color: #f4f4f9; padding: 20px; }
        .container { max-width: 600px; margin: auto; background: white; padding: 20px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        h1, h2 { color: #333; text-align: center; }
        .stats { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; background: #eee; padding: 15px; border-radius: 10px; margin-bottom: 20px; font-weight: bold; text-align: center; }
        .menu { display: flex; gap: 5px; margin-bottom: 20px; flex-wrap: wrap; justify-content: center; }
        button { padding: 10px 12px; cursor: pointer; border: none; border-radius: 8px; background: #6c5ce7; color: white; transition: 0.3s; font-size: 0.9em; }
        .section { display: none; }
        .active { display: block; }
        .item-card { border: 1px solid #ddd; padding: 10px; margin: 8px 0; border-radius: 8px; display: flex; justify-content: space-between; align-items: center; }
        .tag { font-size: 0.7em; padding: 2px 5px; border-radius: 4px; color: white; margin-left: 5px; }
        .tag-food { background: #fab1a0; color: #d63031; }
        .tag-skin { background: #55efc4; color: #000; }
        .status-msg { color: #e74c3c; font-weight: bold; text-align: center; min-height: 1.5em; margin-bottom: 10px; }
        .author-note { background: #e8f4fd; border-left: 5px solid #3498db; padding: 15px; margin-bottom: 20px; border-radius: 5px; position: relative; }
        .admin-btn { font-size: 0.7em; color: #999; border: none; background: none; cursor: pointer; position: absolute; top: 5px; right: 5px; }
        #updateModal { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 25px; border-radius: 15px; z-index: 1000; box-shadow: 0 0 30px rgba(0,0,0,0.3); width: 85%; max-height: 70vh; overflow-y: auto; }
        .version-block { border-bottom: 1px solid #eee; padding-bottom: 10px; margin-bottom: 10px; }
        .version-tag { background: #6c5ce7; color: white; padding: 2px 8px; border-radius: 5px; font-size: 0.8em; }
        #overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.4); z-index: 999; }
    </style>
</head>
<body>

<div class="container">
    <h1>ç¥å¥‡è£œçµ¦ç¸½éƒ¨</h1>

    <div class="author-note">
        <strong>ğŸ“¢ ä½œè€…æƒ³å°ä½ èªªï¼š</strong>
        <p id="display-note">è¼‰å…¥ä¸­...</p>
        <button class="admin-btn" onclick="toggleAdmin()">âš™ï¸ ç®¡ç†å“¡</button>
        <div id="admin-panel" style="display:none; margin-top:10px;">
            <input type="text" id="admin-user" placeholder="å¸³è™Ÿ" style="width:70px">
            <input type="password" id="admin-pass" placeholder="å¯†ç¢¼" style="width:70px">
            <textarea id="edit-note" placeholder="æ–°çš„å…¬å‘Šå…§å®¹..." style="width:100%; margin-top:5px;"></textarea>
            <button onclick="updateNote()" style="background:#2ecc71; width:100%;">å„²å­˜å…¬å‘Š</button>
        </div>
    </div>

    <div class="stats">
        <div>ğŸ’° é‡‘å¹£<br><span id="money">--</span></div>
        <div>âœ¨ é¡å€¼<br><span id="beauty">--</span>/100</div>
        <div>ğŸ” é£½é£Ÿ<br><span id="hunger">--</span>/100</div>
    </div>

    <div class="menu">
        <button onclick="showSection('work')">è³ºéŒ¢</button>
        <button onclick="showSection('shop')">å•†åº—</button>
        <button onclick="showSection('inventory')">ğŸ’ èƒŒåŒ…</button>
        <button onclick="showSection('diary')">è¯çµ¡ç°¿</button>
        <button onclick="checkIn()">ğŸ“… ç°½åˆ°</button>
        <button onclick="toggleUpdateModal()" style="background:#ffa502">ğŸ“œ æ›´æ–°æ­·å²</button>
        <button onclick="clearSave()" style="background:#e74c3c">é‡ç½®</button>
    </div>

    <div id="status-display" class="status-msg"></div>

    <div id="work" class="section active">
        <button onclick="clickWork()" style="padding: 20px; background: #ff7675; width: 100%; font-weight: bold; border:none; border-radius:10px; color:white;">æ‰“å·¥ (é»æ“Š +10, é£½é£Ÿ -1)</button>
        <div style="background: #fffbe6; padding: 10px; border-radius: 10px; border: 1px solid #ffe58f; margin-top:10px;">
            <h3>ğŸ¤– è‡ªå‹•åŒ–è¨­æ–½</h3>
            <div class="item-card"><span>å·¥è®€ç”Ÿ (+1/ç§’)</span><button onclick="buyAuto('helper', 300)">$300</button></div>
            <div class="item-card"><span>è‡ªå‹•çµå¸³æ©Ÿ (+5/ç§’)</span><button onclick="buyAuto('machine', 1000)">$1000</button></div>
        </div>
    </div>

    <div id="shop" class="section">
        <h2>ç¥å¥‡å•†åº—</h2>
        <div class="item-card"><span>æ‡‰æ€¥åå¸ <span class="tag tag-food">+20</span></span><button onclick="buyItem('æ‡‰æ€¥åå¸', 50, 'food', 20)">$50</button></div>
        <div class="item-card"><span>Nature Face å™´éœ§</span><button onclick="buyItem('Nature Face å™´éœ§', 150, 'skin', 8)">$150</button></div>
        <div class="item-card"><span>é›ªèŠ™è˜­åŒ–å¦æ°´</span><button onclick="buyItem('é›ªèŠ™è˜­åŒ–å¦æ°´', 120, 'skin', 10)">$120</button></div>
        <div class="item-card"><span>æ›¼ç§€é›·æ•¦èª¿ç†æ°´</span><button onclick="buyItem('èª¿ç†æ°´', 120, 'skin', 8)">$120</button></div>
        <div class="item-card"><span>é›ªèŠ™è˜­å¸å¦æ°´</span><button onclick="buyItem('å¸å¦æ°´', 150, 'clean', 0)">$150</button></div>
    </div>

    <div id="inventory" class="section">
        <h2>æˆ‘çš„èƒŒåŒ…</h2>
        <div id="inventory-display" style="background:#f9f9f9; padding:10px; border-radius:10px; min-height:50px; border:1px dashed #ccc;"></div>
    </div>

    <div id="diary" class="section">
        <h2>ä»Šæ—¥è¯çµ¡ç°¿</h2>
        <p style="font-size: 0.8em; color: #666;">* å…§å®¹æœƒéš¨æ™‚è‡ªå‹•å„²å­˜</p>
        <textarea id="diary-box" oninput="saveDiary()" style="width:100%; height:150px; padding:10px; border-radius:10px; border:1px solid #ddd; font-family: inherit;" placeholder="è¦ªæ„›çš„åº—é•·ï¼Œä»Šå¤©å¿ƒæƒ…å¦‚ä½•ï¼Ÿ"></textarea>
    </div>
</div>

<div id="overlay" onclick="toggleUpdateModal()"></div>
<div id="updateModal">
    <h2 style="margin-top:0;">ğŸ“œ ç‰ˆæœ¬æ›´æ–°æ­·å²ç´€éŒ„</h2>
    <hr>
    <div class="version-block"><span class="version-tag">v2.2.2</span> <strong>(ä¿®å¾©ç‰ˆ)</strong><ul><li>[ä¿®æ­£] è¯çµ¡ç°¿å…§å®¹ç¾åœ¨æœƒè‡ªå‹•å„²å­˜è‡³å­˜æª”ä¸­ã€‚</li><li>[ä¿®æ­£] æ‰¾å›æ‰€æœ‰åˆ†é çš„é¡¯ç¤ºå€å¡Šã€‚</li></ul></div>
    <div class="version-block"><span class="version-tag">v2.1</span><ul><li>[æ–°å¢] ç®¡ç†å“¡ç³»çµ± (Tina å°ˆå±¬)ã€‚</li><li>[æ–°å¢] å…¨é¢æ­·å²æ—¥èªŒåŠŸèƒ½ã€‚</li></ul></div>
    <button onclick="toggleUpdateModal()" style="width:100%; padding:10px; background:#6c5ce7; color:white; border:none; border-radius:8px;">é—œé–‰</button>
</div>

<script>
    const ADMIN_USER = "tina0310", ADMIN_PASS = "0287901003";
    let state = { money: 500, beauty: 80, hunger: 70, autoIncome: 0, inventory: [], lastCheckIn: "", authorNote: "æ­¡è¿ä¾†åˆ°è£œçµ¦ç«™ï¼", diaryContent: "" };

    function saveGame() { localStorage.setItem('magicShopSave_v2.2.2', JSON.stringify(state)); }
    function loadGame() {
        const saved = localStorage.getItem('magicShopSave_v2.2.2');
        if (saved) state = Object.assign(state, JSON.parse(saved));
        document.getElementById('display-note').innerText = state.authorNote;
        document.getElementById('diary-box').value = state.diaryContent || "";
    }

    // è¯çµ¡ç°¿è‡ªå‹•å„²å­˜
    function saveDiary() {
        state.diaryContent = document.getElementById('diary-box').value;
        saveGame();
    }

    setInterval(() => {
        state.money += state.autoIncome;
        if (state.hunger > 0) state.hunger -= 0.5;
        else state.beauty = Math.max(0, state.beauty - 1);
        saveGame(); updateUI();
    }, 1000);

    function showSection(id) {
        document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        if (id === 'inventory') renderInventory();
    }

    function buyItem(name, price, type, power) {
        if (state.money < price) { alert("éŒ¢ä¸å¤ ï¼"); return; }
        state.money -= price;
        state.inventory.push({ name, type, power });
        saveGame(); updateUI("å·²è³¼å…¥ " + name);
    }

    function useItem(index) {
        const item = state.inventory[index];
        if (item.type === 'food') state.hunger = Math.min(100, state.hunger + item.power);
        else if (item.name === 'å¸å¦æ°´') state.isDirty = false;
        else state.beauty = Math.min(100, state.beauty + item.power);
        state.inventory.splice(index, 1);
        saveGame(); renderInventory(); updateUI("ä½¿ç”¨äº† " + item.name);
    }

    function renderInventory() {
        const div = document.getElementById('inventory-display');
        div.innerHTML = state.inventory.length === 0 ? "èƒŒåŒ…ç©ºç©ºå¦‚ä¹Ÿ" : "";
        state.inventory.forEach((item, index) => {
            div.innerHTML += `<div class="item-card"><span>${item.name}</span><button onclick="useItem(${index})" style="background:#2ecc71">ä½¿ç”¨</button></div>`;
        });
    }

    function clickWork() { if (state.hunger >= 1) { state.money += 10; state.hunger -= 1; updateUI(); } }
    function buyAuto(type, price) { if (state.money >= price) { state.money -= price; state.autoIncome += (type === 'helper' ? 1 : 5); updateUI(); } }
    function checkIn() {
        const today = new Date().toLocaleDateString();
        if (state.lastCheckIn === today) alert("é ˜éå›‰ï¼");
        else { state.money += 100; state.lastCheckIn = today; saveGame(); updateUI("ç°½åˆ°æˆåŠŸï¼"); }
    }

    function updateUI(msg) {
        document.getElementById('money').innerText = Math.floor(state.money);
        document.getElementById('beauty').innerText = Math.floor(state.beauty);
        document.getElementById('hunger').innerText = Math.floor(state.hunger);
        if (msg) document.getElementById('status-display').innerText = msg;
    }

    function toggleAdmin() { const p = document.getElementById('admin-panel'); p.style.display = (p.style.display === 'block' ? 'none' : 'block'); }
    function updateNote() {
        const u = document.getElementById('admin-user').value, p = document.getElementById('admin-pass').value, n = document.getElementById('edit-note').value;
        if (u === ADMIN_USER && p === ADMIN_PASS) { state.authorNote = n; document.getElementById('display-note').innerText = n; saveGame(); alert("å…¬å‘Šæ›´æ–°ï¼"); toggleAdmin(); }
        else alert("å¤±æ•—ï¼");
    }
    function toggleUpdateModal() {
        const m = document.getElementById('updateModal'), o = document.getElementById('overlay');
        const isShow = m.style.display === 'block';
        m.style.display = isShow ? 'none' : 'block'; o.style.display = isShow ? 'none' : 'block';
    }
    function clearSave() { if(confirm("ç¢ºå®šé‡ç½®ï¼Ÿ")) { localStorage.removeItem('magicShopSave_v2.2.2'); location.reload(); } }

    loadGame(); updateUI();
</script>
</body>
</html>
