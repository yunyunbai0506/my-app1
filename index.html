<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>æœƒè€ƒæˆ°å£«ï¼šç¥å¥‡è£œçµ¦ç¸½éƒ¨ v3.2 è‡ªå‹•è³ºéŒ¢ç‰ˆ</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background-color: #f4f4f9; padding: 20px; line-height: 1.6; }
        .container { max-width: 600px; margin: auto; background: white; padding: 20px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        h1 { text-align: center; color: #333; margin-bottom: 5px; }
        .rank-display { text-align: center; color: #6c5ce7; font-weight: bold; font-size: 1.1em; margin-bottom: 15px; }
        .stats { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; background: #eee; padding: 15px; border-radius: 10px; margin-bottom: 15px; font-weight: bold; text-align: center; }
        .menu { display: flex; gap: 5px; margin-bottom: 20px; flex-wrap: wrap; justify-content: center; }
        button { padding: 8px 12px; cursor: pointer; border: none; border-radius: 8px; background: #6c5ce7; color: white; font-size: 0.85em; }
        .section { display: none; }
        .active { display: block; }
        .item-card { border: 1px solid #ddd; padding: 10px; margin: 8px 0; border-radius: 8px; display: flex; justify-content: space-between; align-items: center; background: #fff; }
        .tag { font-size: 0.7em; padding: 2px 5px; border-radius: 4px; color: white; margin-left: 5px; }
        .tag-food { background: #ff7675; }
        .tag-skin { background: #55efc4; color: #000; }
        .tag-makeup { background: #fdcb6e; color: #000; }
        .tag-auto { background: #0984e3; }
        .status-msg { color: #e74c3c; font-weight: bold; text-align: center; min-height: 1.5em; margin-bottom: 10px; font-size: 0.9em; }
        .author-note { background: #e8f4fd; border-left: 5px solid #3498db; padding: 15px; margin-bottom: 15px; border-radius: 5px; position: relative; }
        textarea { width: 100%; height: 150px; padding: 10px; border-radius: 10px; border: 1px solid #ddd; resize: none; box-sizing: border-box; }
    </style>
</head>
<body>

<div class="container">
    <h1>ç¥å¥‡è£œçµ¦ç¸½éƒ¨</h1>
    <div id="beauty-rank" class="rank-display">é ­éŠœï¼šè¼‰å…¥ä¸­...</div>

    <div class="author-note">
        <strong>ğŸ“¢ å…¬å‘Šï¼š</strong> <span id="display-note">æ­¡è¿åº—é•·ï¼</span>
        <button onclick="toggleAdmin()" style="font-size: 0.7em; background:none; color:#999; float:right;">âš™ï¸ ç®¡ç†</button>
        <div id="admin-panel" style="display:none; margin-top:10px; background:white; padding:10px; border-radius:8px; border:1px solid #ddd;">
            <input type="text" id="admin-user" placeholder="å¸³è™Ÿ" style="width:45%">
            <input type="password" id="admin-pass" placeholder="å¯†ç¢¼" style="width:45%">
            <textarea id="edit-note" placeholder="ä¿®æ”¹å…¬å‘Šå…§å®¹..." style="height:50px; margin-top:5px;"></textarea>
            <button onclick="updateNote()" style="background:#2ecc71; width:100%;">ç™¼å¸ƒ</button>
        </div>
    </div>

    <div id="gift-area"></div>

    <div class="stats">
        <div>ğŸ’° é‡‘å¹£<br><span id="money">--</span></div>
        <div>âœ¨ é¡å€¼<br><span id="beauty">--</span>/100</div>
        <div>ğŸ” é£½é£Ÿ<br><span id="hunger">--</span>/100</div>
    </div>

    <div style="text-align:center; font-size:0.8em; margin-bottom:10px; background:#f1f2f6; padding:5px; border-radius:20px;">
        ğŸš¿ <span id="last-wash-display">--</span> | ğŸ§´ çš®è†šï¼š<span id="skin-status-display">è‰¯å¥½</span> | ğŸ¤– è‡ªå‹•ï¼š<span id="auto-count-display">0</span>
    </div>

    <div class="menu">
        <button onclick="showSection('work')">è³ºéŒ¢</button>
        <button onclick="showSection('shop')">å•†åº—</button>
        <button onclick="showSection('inventory')">ğŸ’ èƒŒåŒ…</button>
        <button onclick="showSection('diary')">è¯çµ¡ç°¿</button>
        <button onclick="washHair()" style="background:#3498db;">ğŸš¿ æ´—é ­</button>
        <button onclick="checkIn()">ğŸ“… ç°½åˆ°</button>
    </div>

    <div id="status-display" class="status-msg"></div>

    <div id="work" class="section active">
        <button onclick="clickWork()" style="width:100%; padding:25px; background:#ff7675; border-radius:10px; color:white; border:none; font-weight:bold; font-size:1.2em;">ğŸ’ª åŠªåŠ›æ‰“å·¥è³ºéŒ¢ (+10)</button>
    </div>

    <div id="shop" class="section">
        <h3>ğŸ± é£Ÿå“ä¾›æ‡‰å€</h3>
        <div class="item-card"><span>æ‡‰æ€¥åå¸ <span class="tag tag-food">+20</span></span><button onclick="buyItem('æ‡‰æ€¥åå¸', 50, 'food', 20)">$50</button></div>
        <div class="item-card"><span>çç å¥¶èŒ¶ <span class="tag tag-food">+10é¡å€¼</span></span><button onclick="buyItem('çç å¥¶èŒ¶', 100, 'food_plus', 15, 10)">$100</button></div>
        <div class="item-card"><span>å°å¼æ’éª¨é£¯ <span class="tag tag-food">+80</span></span><button onclick="buyItem('æ’éª¨é£¯', 250, 'food', 80)">$250</button></div>
        <hr>
        <h3>ğŸ’„ è­·è†šç¾å¦å€</h3>
        <div class="item-card"><span>Nature Face å™´éœ§</span><button onclick="buyItem('Nature Face å™´éœ§', 150, 'skin', 8)">$150</button></div>
        <div class="item-card"><span>é›ªèŠ™è˜­å¸å¦æ°´</span><button onclick="buyItem('å¸å¦æ°´', 150, 'clean', 0)">$150</button></div>
        <div class="item-card"><span>å¯ç«‹ä¿¡ç—˜ç—˜å‡è† </span><button onclick="buyItem('ç—˜ç—˜è†', 220, 'cure', 0)">$220</button></div>
        <hr>
        <h3>ğŸ¤– è‡ªå‹•åŒ–è¨­å‚™</h3>
        <div class="item-card"><span>è‡ªå‹•è³ºéŒ¢æ©Ÿ <span class="tag tag-auto">æ¯ç§’+$2</span></span><button onclick="buyAuto()">$1000</button></div>
    </div>

    <div id="inventory" class="section"><h3>ğŸ’ èƒŒåŒ…</h3><div id="inventory-display"></div></div>
    <div id="diary" class="section"><h3>ğŸ““ è¯çµ¡ç°¿</h3><textarea id="diary-box" oninput="saveDiary()" placeholder="ä»Šå¤©çš„å¿ƒæƒ…..."></textarea></div>
</div>

<script>
    const SAVE_KEY = "Tina_MagicShop_Global_Save";
    const ADMIN_USER = "tina0310", ADMIN_PASS = "0287901003";

    let state = { 
        money: 500, beauty: 80, hunger: 70, inventory: [], 
        lastCheckIn: "", authorNote: "æ­¡è¿å›ä¾†ï¼Œåº—é•·ï¼", 
        diaryContent: "", hasReceivedGift: false,
        lastWashTime: Date.now(), isDirty: false, hasAcne: false,
        autoRobots: 0 // æ–°å¢å±¬æ€§ï¼šè‡ªå‹•æ©Ÿå™¨äººæ•¸é‡
    };

    function saveGame() { localStorage.setItem(SAVE_KEY, JSON.stringify(state)); }
    function loadGame() {
        const saved = localStorage.getItem(SAVE_KEY);
        if (saved) state = Object.assign(state, JSON.parse(saved));
        document.getElementById('display-note').innerText = state.authorNote;
        document.getElementById('diary-box').value = state.diaryContent || "";
        checkGift(); updateUI();
    }

    setInterval(() => {
        // é£½é£Ÿèˆ‡é¡å€¼è‡ªç„¶æè€—
        if (state.hunger > 0) state.hunger -= 0.05;
        let hoursSinceWash = (Date.now() - state.lastWashTime) / (1000 * 60 * 60);
        if (hoursSinceWash > 24) state.beauty = Math.max(0, state.beauty - 0.05);
        if (state.isDirty && Math.random() < 0.0006) state.hasAcne = true;
        if (state.hasAcne) state.beauty = Math.max(0, state.beauty - 0.02);
        
        // ğŸ¤– è‡ªå‹•è³ºéŒ¢é‚è¼¯
        if (state.autoRobots > 0) {
            state.money += (state.autoRobots * 2);
        }

        saveGame(); updateUI();
    }, 1000);

    function buyItem(name, price, type, power, beautyPower = 0) {
        if (state.money < price) { alert("éŒ¢ä¸å¤ ï¼"); return; }
        state.money -= price;
        state.inventory.push({ name, type, power, beautyPower });
        saveGame(); updateUI("è³¼è²·äº† " + name);
    }

    function buyAuto() {
        let price = 1000;
        if (state.money < price) { alert("è‡ªå‹•æ©Ÿå™¨äººå¾ˆè²´çš„ï¼ŒéŒ¢ä¸å¤ ï¼"); return; }
        state.money -= price;
        state.autoRobots += 1;
        saveGame(); updateUI("è§£é– 1 å°è‡ªå‹•æ©Ÿå™¨äººï¼");
    }

    function useItem(index) {
        const item = state.inventory[index];
        if (item.type === 'food') state.hunger = Math.min(100, state.hunger + item.power);
        else if (item.type === 'food_plus') { state.hunger = Math.min(100, state.hunger + item.power); state.beauty = Math.min(100, state.beauty + item.beautyPower); }
        else if (item.type === 'clean') { state.isDirty = false; }
        else if (item.type === 'cure') { if(state.hasAcne){ state.hasAcne = false; state.beauty += 15; } }
        else { state.beauty = Math.min(100, state.beauty + item.power); if (item.type === 'makeup') state.isDirty = true; }
        state.inventory.splice(index, 1);
        saveGame(); renderInventory();
    }

    function renderInventory() {
        const div = document.getElementById('inventory-display');
        div.innerHTML = state.inventory.length === 0 ? "ç©ºç©ºå¦‚ä¹Ÿ" : "";
        state.inventory.forEach((item, index) => {
            div.innerHTML += `<div class="item-card"><span>${item.name}</span><button onclick="useItem(${index})" style="background:#2ecc71">ä½¿ç”¨</button></div>`;
        });
    }

    function clickWork() { if (state.hunger >= 0.5) { state.money += 10; state.hunger -= 0.5; updateUI(); } }
    function washHair() { state.lastWashTime = Date.now(); state.beauty = Math.min(100, state.beauty + 5); saveGame(); }
    function checkIn() {
        const today = new Date().toLocaleDateString();
        if (state.lastCheckIn === today) alert("é ˜éå›‰ï¼");
        else { state.money += 100; state.lastCheckIn = today; saveGame(); updateUI("ç°½åˆ°æˆåŠŸï¼"); }
    }
    function saveDiary() { state.diaryContent = document.getElementById('diary-box').value; saveGame(); }
    function showSection(id) { document.querySelectorAll('.section').forEach(s => s.classList.remove('active')); document.getElementById(id).classList.add('active'); if (id === 'inventory') renderInventory(); }
    
    function updateUI(msg) {
        document.getElementById('money').innerText = Math.floor(state.money);
        document.getElementById('beauty').innerText = Math.floor(state.beauty);
        document.getElementById('hunger').innerText = Math.floor(state.hunger);
        document.getElementById('auto-count-display').innerText = state.autoRobots;
        if (msg) document.getElementById('status-display').innerText = msg;
        let hours = ((Date.now() - state.lastWashTime) / (1000 * 60 * 60)).toFixed(1);
        document.getElementById('last-wash-display').innerText = hours + " å°æ™‚å‰æ´—é ­";
        document.getElementById('skin-status-display').innerText = state.hasAcne ? "âš ï¸ ç—˜ç—˜" : (state.isDirty ? "å¸¶å¦" : "è‰¯å¥½");
        
        let rank = "ç´ é¡æˆ°å£«";
        if (state.beauty > 95) rank = "âœ¨ æœƒè€ƒå¥³ç¥ âœ¨";
        else if (state.beauty > 85) rank = "ğŸ’„ ç²¾ç·»å¥³å­©";
        else if (state.beauty > 70) rank = "ğŸŒ¸ æ°£è‰²ç´…æ½¤";
        document.getElementById('beauty-rank').innerText = "é ­éŠœï¼š" + rank;
    }

    function checkGift() {
        const area = document.getElementById('gift-area');
        if (!state.hasReceivedGift) area.innerHTML = `<div style="background:#fff3f3; padding:15px; border:2px dashed #ff7675; text-align:center; margin-bottom:10px; border-radius:10px;">ğŸ æ­¡è¿åº—é•·å¤§ç¦®åŒ… <button onclick="receiveGift()" style="background:#ff7675">é ˜å–</button></div>`;
        else area.innerHTML = "";
    }
    function receiveGift() { state.money += 300; state.hasReceivedGift = true; checkGift(); saveGame(); }
    function toggleAdmin() { const p = document.getElementById('admin-panel'); p.style.display = (p.style.display === 'block' ? 'none' : 'block'); }
    function updateNote() {
        const u = document.getElementById('admin-user').value, p = document.getElementById('admin-pass').value;
        if (u === ADMIN_USER && p === ADMIN_PASS) {
            state.authorNote = document.getElementById('edit-note').value;
            document.getElementById('display-note').innerText = state.authorNote;
            saveGame(); alert("å…¬å‘Šæ›´æ–°ï¼"); toggleAdmin();
        } else alert("éŒ¯èª¤ï¼");
    }

    loadGame();
</script>
</body>
</html>
