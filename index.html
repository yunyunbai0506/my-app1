<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æˆ‘çš„é–‹å­¸å…¨èƒ½åŠ©æ‰‹ 7.0</title>
    <style>
        :root { --poya-pink: #ff4757; --poya-blue: #3498db; --nav-bg: #2d3436; }
        body { font-family: sans-serif; background: #f8f9fa; margin: 0; padding-bottom: 30px; }
        
        /* é ‚éƒ¨å°è¦½åˆ— */
        .nav-bar { background: var(--nav-bg); padding: 10px; display: flex; justify-content: center; gap: 15px; position: sticky; top: 0; z-index: 1000; }
        .nav-btn { background: #636e72; color: white; border: none; padding: 10px 20px; border-radius: 20px; cursor: pointer; font-weight: bold; }
        .nav-btn.active { background: var(--poya-pink); }

        .app-section { display: none; padding: 15px; }
        .app-section.active { display: block; }

        /* å•†åŸæ•¸å€¼æ¨£å¼ */
        .money-display { font-size: 1.8rem; color: #2ecc71; font-weight: bold; text-align: center; margin: 10px 0; }
        .stats-row { display: flex; justify-content: space-around; margin-bottom: 15px; }
        .stat-item { font-size: 0.8rem; font-weight: bold; background: #eee; padding: 5px 10px; border-radius: 12px; border: 1px solid #ddd; }

        /* ç°½åˆ°èˆ‡æ‰“å·¥æŒ‰éˆ• */
        .daily-btn { background: #e67e22; color: white; border: none; padding: 12px; width: 100%; border-radius: 10px; font-weight: bold; margin-bottom: 10px; cursor: pointer; }
        .daily-btn:disabled { background: #ccc; }
        .work-btn { background: #f1c40f; color: #333; padding: 15px; width: 100%; border: none; border-radius: 12px; font-weight: bold; font-size: 1.1rem; box-shadow: 0 4px 0 #d4ac0d; margin-bottom: 20px; cursor: pointer; }

        /* å•†å“åˆ—è¡¨ */
        .tab-bar { display: flex; overflow-x: auto; padding: 10px 0; gap: 10px; border-bottom: 1px solid #eee; margin-bottom: 10px; }
        .shop-tab { padding: 8px 15px; border-radius: 20px; border: none; background: #ddd; white-space: nowrap; font-size: 0.85rem; flex-shrink: 0; }
        .shop-tab.active { background: var(--poya-blue); color: white; }
        .shop-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .item-card { background: white; padding: 12px; border-radius: 12px; border: 1px solid #eee; display: flex; flex-direction: column; justify-content: space-between; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .item-card.special { border: 2px solid var(--poya-pink); background: #fffafa; }
        .item-price { color: var(--poya-pink); font-weight: bold; margin: 5px 0; }

        /* èƒŒåŒ…æ¨£å¼ */
        .inventory-section { background: white; padding: 15px; border-radius: 12px; margin-top: 20px; border: 2px dashed var(--poya-blue); }
        .bag-item { display: inline-flex; align-items: center; background: #e3f2fd; padding: 5px 10px; margin: 3px; border-radius: 5px; font-size: 0.8rem; border: 1px solid #b3e5fc; }
        .use-btn { background: #2ecc71; color: white; border: none; padding: 2px 5px; border-radius: 4px; margin-left: 5px; cursor: pointer; }
    </style>
</head>
<body>

<div class="nav-bar">
    <button id="navContact" class="nav-btn active" onclick="switchApp('contact')">ğŸ“ è¯çµ¡ç°¿</button>
    <button id="navShop" class="nav-btn" onclick="switchApp('shop')">ğŸª æ•¸ä½å¯¶é›…</button>
</div>

<div id="contactSec" class="app-section active">
    <div style="background: white; padding: 20px; border-radius: 15px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
        <h3>ğŸ“… ä»Šæ—¥å‚™å¿˜éŒ„</h3>
        <p style="font-size:0.8rem; color:#666;">ï¼ˆè¼¸å…¥å¾Œæœƒè‡ªå‹•å„²å­˜è‡³æ‰‹æ©Ÿï¼‰</p>
        <textarea id="memoInput" style="width:100%; height:350px; border-radius:10px; padding:15px; border:1px solid #ddd; box-sizing:border-box; font-size: 1rem; line-height:1.5; resize:none;" placeholder="åœ¨æ­¤è¼¸å…¥é–‹å­¸æº–å‚™ã€ä½œæ¥­æ¸…å–®..."></textarea>
    </div>
</div>

<div id="shopSec" class="app-section">
    <div class="money-display">ğŸ’° $<span id="balance">0</span></div>
    <div class="stats-row">
        <div class="stat-item">âœ¨ é¡å€¼: <span id="beautyStat">0</span></div>
        <div class="stat-item">ğŸ” é£½é£Ÿ: <span id="fullStat">100</span></div>
        <div class="stat-item">ğŸ“ˆ ç§’ç”¢: $<span id="incomeVal">0</span></div>
    </div>

    <button id="dailyBtn" class="daily-btn" onclick="dailyCheckIn()">ğŸ“… æ¯æ—¥ç°½åˆ° (é ˜ $500)</button>
    <button class="work-btn" onclick="work()">ğŸ–ï¸ åŠªåŠ›æ‰“å·¥è³ºéŒ¢ (+$10)</button>

    <div class="tab-bar">
        <button class="shop-tab active" onclick="setTab('ä¿é¤Š')">ğŸ§¼ è‡‰éƒ¨ä¿é¤Š</button>
        <button class="shop-tab" onclick="setTab('ç¾å¦')">ğŸ’„ å½©å¦å€</button>
        <button class="shop-tab" onclick="setTab('é£Ÿå“')">ğŸ¥¤ é›¶é£Ÿé£²å“</button>
        <button class="shop-tab" onclick="setTab('æŠ•è³‡')">ğŸ›ï¸ ç”¢é‡‘æŠ•è³‡</button>
    </div>
    <div class="shop-grid" id="shopGrid"></div>

    <div class="inventory-section">
        <b>ğŸ’ æˆ‘çš„èƒŒåŒ…ï¼š</b>
        <div id="bagDisplay" style="margin-top:10px; min-height: 30px;">ç©ºç©ºçš„</div>
    </div>
</div>

<script>
    // 1. åˆå§‹åŒ–è³‡æ–™ (è®€å–å„²å­˜)
    let money = parseInt(localStorage.getItem('game_money')) || 0;
    let autoIncome = parseInt(localStorage.getItem('game_income')) || 0;
    let beauty = parseInt(localStorage.getItem('game_beauty')) || 0;
    let fullness = parseInt(localStorage.getItem('game_fullness')) || 100;
    let bag = JSON.parse(localStorage.getItem('game_bag')) || [];
    let lastCheckIn = localStorage.getItem('last_checkin') || "";
    let currentTab = 'ä¿é¤Š';

    const products = {
        'ä¿é¤Š': [
            { name: "é›ªèŠ™è˜­å«©ç™½åŒ–å¦æ°´", price: 199, effect: { type: 'beauty', val: 5 } },
            { name: "æ›¼ç§€é›·æ•¦èª¿ç†æ°´", price: 220, effect: { type: 'beauty', val: 6 } },
            { name: "æŠ—ç—˜æ§æ²¹æ´—é¡æ…•æ–¯", price: 180, effect: { type: 'beauty', val: 5 } },
            { name: "Nature Face å™´éœ§", price: 150, effect: { type: 'beauty', val: 4 } },
            { name: "é›ªèŠ™è˜­ä¹³æ¶²", price: 250, effect: { type: 'beauty', val: 8 } },
            { name: "å¯ç«‹ä¿¡ç—˜ç—˜å‡è† ", price: 280, effect: { type: 'beauty', val: 10 } },
            { name: "BiorÃ© å°è’¼è˜­é˜²æ›¬", price: 280, effect: { type: 'beauty', val: 7 } }
        ],
        'ç¾å¦': [
            { name: "æƒ¹æˆ‘æ¸…çˆ½èœœç²‰", price: 160, effect: { type: 'beauty', val: 15 } },
            { name: "éŸ“ç³»å£ç´…", price: 420, effect: { type: 'beauty', val: 25 } },
            { name: "ä¹å®®æ ¼çœ¼å½±ç›¤", price: 580, effect: { type: 'beauty', val: 40 } },
            { name: "é–‹å­¸å¤§ç¦®åŒ…", price: 223, effect: { type: 'beauty', val: 100 }, special: true }
        ],
        'é£Ÿå“': [
            { name: "çç å¥¶èŒ¶", price: 65, effect: { type: 'full', val: 25 } },
            { name: "å’”è¾£å§†ä¹…", price: 45, effect: { type: 'full', val: 15 } },
            { name: "è¾›æ‹‰éºµ", price: 160, effect: { type: 'full', val: 65 } },
            { name: "åˆå¾Œç´…èŒ¶", price: 45, effect: { type: 'full', val: 12 } }
        ],
        'æŠ•è³‡': [
            { name: "è‡ªå‹•å°åŠ©æ‰‹", price: 1200, income: 10 },
            { name: "æ•¸ä½å¯¶é›…åˆ†åº—", price: 10000, income: 100 },
            { name: "å®‡å®™ç‰©æµä¸­å¿ƒ", price: 50000, income: 600 }
        ]
    };

    // 2. åˆ‡æ›æ‡‰ç”¨ç¨‹å¼
    function switchApp(app) {
        document.getElementById('contactSec').classList.toggle('active', app === 'contact');
        document.getElementById('shopSec').classList.toggle('active', app === 'shop');
        document.getElementById('navContact').classList.toggle('active', app === 'contact');
        document.getElementById('navShop').classList.toggle('active', app === 'shop');
    }

    // 3. æ›´æ–°ä»‹é¢
    function updateUI() {
        document.getElementById('balance').innerText = money.toLocaleString();
        document.getElementById('beautyStat').innerText = beauty;
        document.getElementById('fullStat').innerText = Math.floor(fullness);
        document.getElementById('incomeVal').innerText = autoIncome;

        const grid = document.getElementById('shopGrid');
        grid.innerHTML = '';
        products[currentTab].forEach((p, idx) => {
            const canAfford = money >= p.price;
            grid.innerHTML += `
                <div class="item-card ${p.special ? 'special' : ''}">
                    <div style="font-weight:bold; font-size:0.85rem;">${p.name}</div>
                    <div style="font-size:0.7rem; color:#666; margin:3px 0;">${p.income ? '+$'+p.income+'/ç§’' : 'æ•ˆæœ:+'+p.effect.val}</div>
                    <div class="item-price">$${p.price}</div>
                    <button class="buy-btn" ${canAfford ? '' : 'disabled'} onclick="buy('${currentTab}', ${idx})" style="background:${canAfford?'#3498db':'#ccc'}; color:white; border:none; padding:6px; border-radius:5px; cursor:pointer;">è³¼è²·</button>
                </div>
            `;
        });

        const bagDiv = document.getElementById('bagDisplay');
        bagDiv.innerHTML = bag.length ? '' : 'ç©ºç©ºçš„';
        bag.forEach((item, idx) => {
            bagDiv.innerHTML += `<span class="bag-item">${item.name}<button class="use-btn" onclick="use(${idx})">ä½¿ç”¨</button></span>`;
        });

        // æª¢æŸ¥ç°½åˆ°ç‹€æ…‹
        const today = new Date().toISOString().split('T')[0];
        if (lastCheckIn === today) {
            document.getElementById('dailyBtn').innerText = "âœ… ä»Šå¤©å·²é ˜éç°½åˆ°çå‹µ";
            document.getElementById('dailyBtn').disabled = true;
        }
        save();
    }

    // 4. åŠŸèƒ½é‚è¼¯
    function dailyCheckIn() {
        const today = new Date().toISOString().split('T')[0];
        if (lastCheckIn !== today) {
            money += 500;
            lastCheckIn = today;
            localStorage.setItem('last_checkin', lastCheckIn);
            alert("âœ¨ ç°½åˆ°æˆåŠŸï¼ç²å¾— $500 çé‡‘ï¼");
            updateUI();
        }
    }

    function buy(tab, idx) {
        const p = products[tab][idx];
        if (money >= p.price) {
            money -= p.price;
            if (p.income) autoIncome += p.income;
            else bag.push(p);
            updateUI();
        }
    }

    function use(idx) {
        const item = bag[idx];
        if (item.effect.type === 'beauty') beauty += item.effect.val;
        if (item.effect.type === 'full') fullness += item.effect.val;
        bag.splice(idx, 1);
        updateUI();
    }

    function work() { money += 10; updateUI(); }
    function setTab(t) { currentTab = t; updateUI(); }
    function save() {
        localStorage.setItem('game_money', money);
        localStorage.setItem('game_income', autoIncome);
        localStorage.setItem('game_beauty', beauty);
        localStorage.setItem('game_fullness', fullness);
        localStorage.setItem('game_bag', JSON.stringify(bag));
    }

    // è¯çµ¡ç°¿å­˜æª”é‚è¼¯
    document.getElementById('memoInput').value = localStorage.getItem('my_memo') || "";
    document.getElementById('memoInput').addEventListener('input', (e) => {
        localStorage.setItem('my_memo', e.target.value);
    });

    // 5. è¨ˆæ™‚å™¨ï¼šè¢«å‹•æ”¶å…¥ & é£½é£Ÿåº¦ä¸‹é™
    setInterval(() => {
        money += autoIncome;
        if (fullness > 0) fullness -= 0.05;
        updateUI();
    }, 1000);

    updateUI();
</script>
</body>
</html>
